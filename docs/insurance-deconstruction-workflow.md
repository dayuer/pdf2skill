# 保险产品解构工作流

> pdf2skill 处理复杂保险产品（主险+附加险+运营规则+附件清单）的标准方法论。

---

## 核心思想

❌ 传统做法：全文切碎 → 向量数据库 → 信息遗漏 + 逻辑错乱

✅ 正确做法：**分层解析、网状关联**

---

## 第一阶段：文件分类与处理优先级

| Level  | 类型       | 文件示例                      | 处理策略                       |
| ------ | ---------- | ----------------------------- | ------------------------------ |
| **L1** | 核心锚点   | 保障利益表.xlsx               | 结构化 JSON → 全局骨架         |
| **L2** | 契约规则   | _保险条款_.pdf（主险/附加险） | 语义分块 + 强元数据标签        |
| **L3** | 准入与限制 | 健康告知、投保须知、责任免除  | 决策树 / 规则引擎格式          |
| **L4** | 服务与名录 | 医院清单、康复机构清单        | **关系表/字典**（不做向量化）  |
| **L5** | 辅助语料   | QA、计划书、电子保单样本      | 相似度训练集（对齐到标准规则） |

---

## 第二阶段：结构化解构工作流

### Step 1：Excel 建立全局数据骨架（处理 L1）

提取 `保障利益表.xlsx`，转化为结构化 JSON。

- 提取：责任名称、保额上限、免赔额、赔付比例
- 此骨架作为后续所有解析的**校验清单**

### Step 2：条款拆解与责任挂载（处理 L2）

对条款 PDF 进行 Chunk 切分（使用 chunker_v0.2）。

- **强标签元数据**：条款类型（主险/附加门急诊）、责任模块（药品费）、条款性质（理赔条件/定义）
- 将 Chunk 挂载到 Step 1 骨架的对应节点

### Step 3：准入条件与负面清单（处理 L3）

- **健康告知** → 决策树格式，区分首次投保/加包投保
- **责任免除** → 主险免责 + 各附加险特有免责 → 负面清单库
- **新/转保规则** → 等待期、免赔额连续性规则

### Step 4：独立抽取实体清单（处理 L4）

医院清单、康复机构清单 → **关系型数据表/字典**。

- ❌ 绝不做向量化切块（检索命中率极低）
- ✅ 结构化为可精确检索的 Key-Value

### Step 5：QA 与计划书对齐（处理 L5）

- QA 不创造新规则，而是口语化提问的**相似度训练集**
- 对齐到前四步提炼出的标准规则

---

## 第三阶段：防遗漏交叉验证

完成后知识库包含四层：

```
1. 骨架表（结构化 JSON）
2. 条款向量库（语义 Chunk）
3. 规则树（决策条件）
4. 白名单字典（精确检索）
```

验证方法：设计测试问题，检查系统调用路径。例：

> "客户投保了门急诊加油包，因为感冒去了指定民营医院，怎么赔？"

正确调用路径：

1. 查骨架表 → 确认责任保额和免赔额
2. 查门急诊附加险条款 → 确认理赔标准
3. 查指定民营医院清单 → 确认医院在白名单内
4. 查免责条款 → 确认感冒不属于除外责任
